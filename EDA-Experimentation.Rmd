## EDA, Package Experimentation and Prelimanary Question Development

Installing and loading packages
```{r}
# Latest version of ENMtools on CRAN is not for R 4.3.1
# We must install ENMtools from authors github

# install.packages("devtools")
library(devtools)

# install_github("danlwarren/ENMTools")
library(ENMTools)

library(tidyverse)

# install.packages("leaflet")
library(leaflet)

# install.packages("terra")
library(terra)
```



How to Build an ENM tools species object

```{r}
raw_platypus <- read.csv("raw_data/Platypus5-10-23.csv")
platypusPresence <- raw_platypus %>% 
  select(decimalLongitude, decimalLatitude)


```



```{r}
# Get some environmental data
# Gets bioclim layers
env <- raster::getData(name = "worldclim", res = 10, var = "bio")

# Trim down the environmental layer to frame data better
env <- crop(env, extent(110, 155, -45, -8))
plot(env[[1]])
```



```{r}
# We will do montecarlo tests to test similarities between species and clades and such
# We package each lineage up in an ENMtools species object

platypus <- enmtools.species()
# Creates empty object with slots for various values

platypus$species.name <- "Ornithorhynchus anatinus"
platypus$presence.points <- platypusPresence
#platypus$presence.points <- vect(platypusPresence, geom=c("decimalLongitude", "decimalLatitude"), crs="", keepgeom=FALSE)

# Check format of the enmtools.species
platypus <- check.species(platypus)

interactive.plot.enmtools.species(platypus)
```

```{r}
platypus.mx <- enmtools.maxent(platypus, env)

platypus.mx$response.plots
```

Green is distribution of Environmental variable across background (Australia)
Red is distribution of presence points (frequency of which species appears across those variables)
Suitability Function our model has estimated (Marginal suitability)

```{r}
platypus.mx$training.evaluation
```
AUC = Area Under Curve


```{r}
ggplot(platypusPresence, aes(x = decimalLongitude, y = decimalLatitude)) +
  geom_point(size = 0.01) +
  labs(
    x = "Longitude",           
    y = "Latitude",     
    title = "Title"
  ) +
  theme(plot.title = element_text(hjust = 0.5))
```

```{r}

platypus.mx <- enmtools.maxent(platypus, env, test.prop = 0.3)

platypus.mx

platypus.bc <- enmtools.bc(platypus, env, test.prop = 0.3)

platypus.bc

```


```{r}
interactive.plot.enmtools.model(platypus.bc)
```


```{r}
platypus.dm <- enmtools.dm(platypus, env)

interactive.plot.enmtools.model(platypus.dm)
```

